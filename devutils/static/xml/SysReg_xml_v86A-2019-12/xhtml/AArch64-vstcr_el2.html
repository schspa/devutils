<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>VSTCR_EL2</title>
    <link href="insn.css" rel="stylesheet" type="text/css" />
  </head>
  <body><table align="center"><tr><td><div class="topbar"><a href="AArch32-regindex.html">AArch32 Registers</a></div></td><td><div class="topbar"><a href="AArch64-regindex.html">AArch64 Registers</a></div></td><td><div class="topbar"><a href="AArch32-sysindex.html">AArch32 Instructions</a></div></td><td><div class="topbar"><a href="AArch64-sysindex.html">AArch64 Instructions</a></div></td><td><div class="topbar"><a href="enc_index.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="ext_alpha_index.html">External Registers</a></div></td><td><div class="topbar"><a href="ext_enc_index.html">External Registers by Offset</a></div></td><td><div class="topbar"><a href="func_index.html">Registers by Functional Group</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><hr /><h1 class="register-section">VSTCR_EL2, Virtualization Secure Translation Control Register</h1><p>The VSTCR_EL2 characteristics are:</p><h2>Purpose</h2>
        <p>The control register for stage 2 of the Secure EL1&amp;0 translation regime.</p>
      <h2>Configuration</h2><p>This register is present only
    when ARMv8.4-SecEL2 is implemented.
      
    Otherwise, direct accesses to VSTCR_EL2 are <span class="arm-defined-word">UNDEFINED</span>.</p>
        <p>This register has no effect if EL2 is not enabled in the current Security state.</p>
      <h2>Attributes</h2>
            <p>VSTCR_EL2 is a 64-bit register.</p>
          <h2>Field descriptions</h2><p>The VSTCR_EL2 bit assignments are:</p><table class="regdiagram"><thead><tr><td>63</td><td>62</td><td>61</td><td>60</td><td>59</td><td>58</td><td>57</td><td>56</td><td>55</td><td>54</td><td>53</td><td>52</td><td>51</td><td>50</td><td>49</td><td>48</td><td>47</td><td>46</td><td>45</td><td>44</td><td>43</td><td>42</td><td>41</td><td>40</td><td>39</td><td>38</td><td>37</td><td>36</td><td>35</td><td>34</td><td>33</td><td>32</td></tr></thead><tbody><tr class="firstrow"><td class="lr" colspan="32"><a href="#0_63">RES0</a></td></tr><tr class="firstrow"><td class="lr" colspan="1"><a href="#1_31">RES1</a></td><td class="lr" colspan="1"><a href="#SA_30">SA</a></td><td class="lr" colspan="1"><a href="#SW_29">SW</a></td><td class="lr" colspan="13"><a href="#0_28">RES0</a></td><td class="lr" colspan="2"><a href="#TG0_15">TG0</a></td><td class="lr" colspan="6"><a href="#0_13">RES0</a></td><td class="lr" colspan="2"><a href="#SL0_7">SL0</a></td><td class="lr" colspan="6"><a href="#T0SZ_5">T0SZ</a></td></tr></tbody><tfoot><tr><td>31</td><td>30</td><td>29</td><td>28</td><td>27</td><td>26</td><td>25</td><td>24</td><td>23</td><td>22</td><td>21</td><td>20</td><td>19</td><td>18</td><td>17</td><td>16</td><td>15</td><td>14</td><td>13</td><td>12</td><td>11</td><td>10</td><td>9</td><td>8</td><td>7</td><td>6</td><td>5</td><td>4</td><td>3</td><td>2</td><td>1</td><td>0</td></tr></tfoot></table><div class="text_before_fields">
      
  <p>Any of the bits in VSTCR_EL2 are permitted to be cached in a TLB.</p>

    </div><h4 id="0_63">
                Bits [63:32]
              </h4>
            <p>Reserved, <span class="arm-defined-word">RES0</span>.</p>
          <h4 id="1_31">
                Bit [31]
              </h4>
            <p>Reserved, <span class="arm-defined-word">RES1</span>.</p>
          <h4 id="SA_30">SA, bit [30]
              </h4>
          
  <p>Secure stage 2 translation output address space.</p>

          <table class="valuetable"><tr><th>SA</th><th>Meaning</th></tr><tr><td class="bitfield">0b0</td><td>
  <p>All stage 2 translations for the Secure IPA space access the Secure PA space.</p>
</td></tr><tr><td class="bitfield">0b1</td><td>
  <p>All stage 2 translations for the Secure IPA space access the Non-secure PA space.</p>
</td></tr></table>
            
  <p>When the value of VSTCR_EL2.SW is 1, this bit behaves as 1 for all purposes other than reading back the value of the bit.</p>

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><h4 id="SW_29">SW, bit [29]
              </h4>
          
  <p>Secure stage 2 translation address space.</p>

          <table class="valuetable"><tr><th>SW</th><th>Meaning</th></tr><tr><td class="bitfield">0b0</td><td>
  <p>All stage 2 translation table walks for the Secure IPA space are to the Secure PA space.</p>
</td></tr><tr><td class="bitfield">0b1</td><td>
  <p>All stage 2 translation table walks for the Secure IPA space are to the Non-secure PA space.</p>
</td></tr></table>
            
  

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><h4 id="0_28">
                Bits [28:16]
              </h4>
            <p>Reserved, <span class="arm-defined-word">RES0</span>.</p>
          <h4 id="TG0_15">TG0, bits [15:14]
                  </h4>
          
  <p>Secure stage 2 granule size for <a href="AArch64-vsttbr_el2.html">VSTTBR_EL2</a>.</p>

          <table class="valuetable"><tr><th>TG0</th><th>Meaning</th></tr><tr><td class="bitfield">0b00</td><td>
  <p>4KB.</p>
</td></tr><tr><td class="bitfield">0b01</td><td>
  <p>64KB.</p>
</td></tr><tr><td class="bitfield">0b10</td><td>
  <p>16KB.</p>
</td></tr></table>
            
  <p>Other values are reserved.</p>
<p>If <span class="xref">ARMv8.5-GTG</span> is implemented, <a href="AArch64-id_aa64mmfr0_el1.html">ID_AA64MMFR0_EL1</a>.{TGran4_2, TGran16_2, TGran64_2} indicate which granule sizes are supported for Level 2 translation.</p>
<p>If <span class="xref">ARMv8.5-GTG</span> is not implemented, <a href="AArch64-id_aa64mmfr0_el1.html">ID_AA64MMFR0_EL1</a>.{TGran4, TGran16, TGran64} indicate which granule sizes are supported.</p>
<p>If the value is programmed to either a reserved value, or a size that has not been implemented, then for all purposes other than read back from this register, the hardware will treat the field as if it has been programmed to an <span class="arm-defined-word">IMPLEMENTATION DEFINED</span> choice of the sizes that has been implemented.</p>
<p>It is <span class="arm-defined-word">IMPLEMENTATION DEFINED</span> whether the value read back is the value programmed or the value that corresponds to the size chosen.</p>

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><h4 id="0_13">
                Bits [13:8]
              </h4>
            <p>Reserved, <span class="arm-defined-word">RES0</span>.</p>
          <h4 id="SL0_7">SL0, bits [7:6]
                  <div style="font-size:smaller;"><br />When ARMv8.4-TTST is implemented:
                </div></h4>
          
  <p>Starting level of the Secure stage 2 translation lookup, controlled by VSTCR_EL2. The meaning of this field depends on the value of VSTCR_EL2.TG0.</p>

          <table class="valuetable"><tr><th>SL0</th><th>Meaning</th></tr><tr><td class="bitfield">0b00</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 2. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 3.</p>
</td></tr><tr><td class="bitfield">0b01</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 1. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 2.</p>
</td></tr><tr><td class="bitfield">0b10</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 0. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 1.</p>
</td></tr><tr><td class="bitfield">0b11</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 3.</p>
</td></tr></table>
            
  <p>All other values are reserved. If this field is programmed to a reserved value, or to a value that is not consistent with the programming of VSTCR_EL2.T0SZ, then a stage 2 level 0 Translation fault is generated.</p>

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><h4 id="SL0_7"><div style="font-size:smaller;"><br />
              Otherwise:
            </div></h4>
          
  <p>Starting level of the Secure stage 2 translation lookup, controlled by VSTCR_EL2. The meaning of this field depends on the value of VSTCR_EL2.TG0.</p>

          <table class="valuetable"><tr><th>SL0</th><th>Meaning</th></tr><tr><td class="bitfield">0b00</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 2. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 3.</p>
</td></tr><tr><td class="bitfield">0b01</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 1. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 2.</p>
</td></tr><tr><td class="bitfield">0b10</td><td>
  <p>If VSTCR_EL2.TG0 is <span class="binarynumber">0b00</span> (4KB granule), start at level 0. If VSTCR_EL2.TG0 is <span class="binarynumber">0b10</span> (16KB granule) or <span class="binarynumber">0b01</span> (64KB granule), start at level 1.</p>
</td></tr></table>
            
  <p>All other values are reserved. If this field is programmed to a reserved value, or to a value that is not consistent with the programming of VSTCR_EL2.T0SZ, then a stage 2 level 0 Translation fault is generated.</p>

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><h4 id="T0SZ_5">T0SZ, bits [5:0]
                  </h4>
          
  <p>The size offset of the memory region addressed by <a href="AArch64-vsttbr_el2.html">VSTTBR_EL2</a>. The region size is 2<sup>(64-T0SZ)</sup> bytes.</p>
<p>The maximum and minimum possible values for this field depend on the level of translation table and the memory translation granule size, as described in the AArch64 Virtual Memory System Architecture chapter.</p>
<p>If this field is programmed to a value that is not consistent with the programming of SL0, then a stage 2 level 0 Translation fault is generated.</p>

          
            
  

          <p>This field resets to an architecturally <span class="arm-defined-word">UNKNOWN</span> value.</p><div class="text_after_fields">
    
  

    </div><div class="access_mechanisms"><h2>Accessing the VSTCR_EL2</h2><p>Accesses to this register use the following encodings:</p><h4 class="assembler">MRS &lt;Xt&gt;, VSTCR_EL2</h4><table class="access_instructions"><tr><th>op0</th><th>op1</th><th>CRn</th><th>CRm</th><th>op2</th></tr><tr><td>0b11</td><td>0b100</td><td>0b0010</td><td>0b0110</td><td>0b010</td></tr></table><p class="pseudocode">
if PSTATE.EL == EL0 then
    UNDEFINED;
elsif PSTATE.EL == EL1 then
    if HaveEL(EL3) &amp;&amp; SCR_EL3.NS == '1' then
        UNDEFINED;
    elsif EL2Enabled() &amp;&amp; HCR_EL2.&lt;NV2,NV&gt; == '11' then
        return NVMem[0x048];
    elsif EL2Enabled() &amp;&amp; HCR_EL2.NV == '1' then
        AArch64.SystemAccessTrap(EL2, 0x18);
    else
        UNDEFINED;
elsif PSTATE.EL == EL2 then
    if HaveEL(EL3) &amp;&amp; SCR_EL3.NS == '1' then
        UNDEFINED;
    else
        return VSTCR_EL2;
elsif PSTATE.EL == EL3 then
    if SCR_EL3.EEL2 == '0' then
        UNDEFINED;
    else
        return VSTCR_EL2;
              </p><h4 class="assembler">MSR VSTCR_EL2, &lt;Xt&gt;</h4><table class="access_instructions"><tr><th>op0</th><th>op1</th><th>CRn</th><th>CRm</th><th>op2</th></tr><tr><td>0b11</td><td>0b100</td><td>0b0010</td><td>0b0110</td><td>0b010</td></tr></table><p class="pseudocode">
if PSTATE.EL == EL0 then
    UNDEFINED;
elsif PSTATE.EL == EL1 then
    if HaveEL(EL3) &amp;&amp; SCR_EL3.NS == '1' then
        UNDEFINED;
    elsif EL2Enabled() &amp;&amp; HCR_EL2.&lt;NV2,NV&gt; == '11' then
        NVMem[0x048] = X[t];
    elsif EL2Enabled() &amp;&amp; HCR_EL2.NV == '1' then
        AArch64.SystemAccessTrap(EL2, 0x18);
    else
        UNDEFINED;
elsif PSTATE.EL == EL2 then
    if HaveEL(EL3) &amp;&amp; SCR_EL3.NS == '1' then
        UNDEFINED;
    else
        VSTCR_EL2 = X[t];
elsif PSTATE.EL == EL3 then
    if SCR_EL3.EEL2 == '0' then
        UNDEFINED;
    else
        VSTCR_EL2 = X[t];
              </p></div><br /><br /><hr /><table align="center"><tr><td><div class="topbar"><a href="AArch32-regindex.html">AArch32 Registers</a></div></td><td><div class="topbar"><a href="AArch64-regindex.html">AArch64 Registers</a></div></td><td><div class="topbar"><a href="AArch32-sysindex.html">AArch32 Instructions</a></div></td><td><div class="topbar"><a href="AArch64-sysindex.html">AArch64 Instructions</a></div></td><td><div class="topbar"><a href="enc_index.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="ext_alpha_index.html">External Registers</a></div></td><td><div class="topbar"><a href="ext_enc_index.html">External Registers by Offset</a></div></td><td><div class="topbar"><a href="func_index.html">Registers by Functional Group</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><p class="versions">13/12/2019 15:13; 391b5248b29fb2f001ef74792eaacbd6fc72f211</p><p class="copyconf">Copyright © 2010-2019 Arm Limited or its affiliates. All rights reserved. This document is Non-Confidential.</p></body>
</html>
